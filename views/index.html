<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title></title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    Potato
    <div id="connection"></div>
    <script>
      const ws = new WebSocket( 'wss://' + window.location.hostname );
      ws.binaryType = 'arraybuffer';

      ws.addEventListener('open', function () {
        connection.textContent = 'connected';
        ws.send( Date.now() );
      });

      ws.addEventListener('close', function () {
        connection.textContent = 'disconnected';
      });

      ws.addEventListener('message', function ( data ) {

        console.log(`Roundtrip time: ${Date.now() - data} ms`);

        setTimeout( function () {

          ws.send( Date.now() );

        }, 500);

      } );
    </script>
  </body>
</html>
